"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),lineEq=function(t,e,i,o,n){var a=(t-e)/(i-o);return a*n+(e-a*o)},getRandomInt=function(t,e){return Math.floor(Math.random()*(e-t+1))+t},getRandomFloat=function(t,e){return(Math.random()*(e-t)+t).toFixed(2)},setRange=function(t){for(var e in t)void 0==t[e]?t[e]=[0,0]:"number"==typeof t[e]&&(t[e]=[-1*t[e],t[e]])},getMousePos=function(t){var e=0,i=0;return t||(t=window.event),t.pageX||t.pageY?(e=t.pageX,i=t.pageY):(t.clientX||t.clientY)&&(e=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,i=t.clientY+document.body.scrollTop+document.documentElement.scrollTop),{x:e,y:i}},Item=function(){function t(e,i){_classCallCheck(this,t),this.DOM={el:e},this.options={image:{translation:{x:-10,y:-10,z:0},rotation:{x:0,y:0,z:0}},title:{translation:{x:20,y:10,z:0}},text:{translation:{x:20,y:50,z:0},rotation:{x:0,y:0,z:-20}},deco:{translation:{x:-20,y:0,z:0},rotation:{x:0,y:0,z:3}},shadow:{translation:{x:30,y:20,z:0},rotation:{x:0,y:0,z:-2},reverseAnimation:{duration:2,ease:"Back.easeOut"}},content:{translation:{x:5,y:3,z:0}}},Object.assign(this.options,i),this.DOM.animatable={},this.DOM.animatable.image=this.DOM.el.querySelector(".box__img"),this.DOM.animatable.title=this.DOM.el.querySelector(".box__title"),this.DOM.animatable.text=this.DOM.el.querySelector(".box__text"),this.DOM.animatable.deco=this.DOM.el.querySelector(".box__deco"),this.DOM.animatable.shadow=this.DOM.el.querySelector(".box__shadow"),this.DOM.animatable.content=this.DOM.el.querySelector(".box__content"),this.initEvents()}return _createClass(t,[{key:"initEvents",value:function(){var t=this,e=!1;this.mouseenterFn=function(){e&&(e=!1),clearTimeout(t.mousetime),t.mousetime=setTimeout(function(){return e=!0},40)},this.mousemoveFn=function(i){return requestAnimationFrame(function(){e&&t.tilt(i)})},this.mouseleaveFn=function(i){return requestAnimationFrame(function(){if(e&&allowTilt){e=!1,clearTimeout(t.mousetime);for(var i in t.DOM.animatable)void 0!=t.DOM.animatable[i]&&void 0!=t.options[i]&&TweenMax.to(t.DOM.animatable[i],void 0!=t.options[i].reverseAnimation?t.options[i].reverseAnimation.duration||0:1.5,{ease:void 0!=t.options[i].reverseAnimation?t.options[i].reverseAnimation.ease||"Power2.easeOut":"Power2.easeOut",x:0,y:0,z:0,rotationX:0,rotationY:0,rotationZ:0})}})},this.DOM.el.addEventListener("mouseenter",this.mouseenterFn),this.DOM.el.addEventListener("mousemove",this.mousemoveFn),this.DOM.el.addEventListener("mouseleave",this.mouseleaveFn)}},{key:"tilt",value:function(t){if(allowTilt){var e=getMousePos(t),i={left:document.body.scrollLeft+document.documentElement.scrollLeft,top:document.body.scrollTop+document.documentElement.scrollTop},o=this.DOM.el.getBoundingClientRect(),n={x:e.x-o.left-i.left,y:e.y-o.top-i.top};for(var a in this.DOM.animatable)if(void 0!=this.DOM.animatable[a]&&void 0!=this.options[a]){var r=void 0!=this.options[a]?this.options[a].translation||{x:0,y:0,z:0}:{x:0,y:0,z:0},l=void 0!=this.options[a]?this.options[a].rotation||{x:0,y:0,z:0}:{x:0,y:0,z:0};setRange(r),setRange(l);var s={translation:{x:(r.x[1]-r.x[0])/o.width*n.x+r.x[0],y:(r.y[1]-r.y[0])/o.height*n.y+r.y[0],z:(r.z[1]-r.z[0])/o.height*n.y+r.z[0]},rotation:{x:(l.x[1]-l.x[0])/o.height*n.y+l.x[0],y:(l.y[1]-l.y[0])/o.width*n.x+l.y[0],z:(l.z[1]-l.z[0])/o.width*n.x+l.z[0]}};TweenMax.to(this.DOM.animatable[a],1.5,{ease:"Power1.easeOut",x:s.translation.x,y:s.translation.y,z:s.translation.z,rotationX:s.rotation.x,rotationY:s.rotation.y,rotationZ:s.rotation.z})}}}}]),t}(),Overlay=function(){function t(){_classCallCheck(this,t),this.DOM={el:document.querySelector(".overlay")},this.DOM.reveal=this.DOM.el.querySelector(".overlay__reveal"),this.DOM.items=this.DOM.el.querySelectorAll(".overlay__item"),this.DOM.close=this.DOM.el.querySelector(".overlay__close")}return _createClass(t,[{key:"show",value:function(t){var e=this;this.contentItem=t,this.DOM.el.classList.add("overlay--open"),TweenMax.to(this.DOM.reveal,.5,{ease:"Power1.easeInOut",x:"0%",onComplete:function(){document.body.classList.add("preview-open"),e.revealItem(t),TweenMax.to(e.DOM.reveal,.5,{delay:.2,ease:"Power3.easeOut",x:"-100%"}),e.DOM.close.style.opacity=1}})}},{key:"revealItem",value:function(){this.contentItem.style.opacity=1;var t=[];t.push(this.contentItem.querySelector(".box__shadow")),t.push(this.contentItem.querySelector(".box__img")),t.push(this.contentItem.querySelector(".box__title")),t.push(this.contentItem.querySelector(".box__text")),t.push(this.contentItem.querySelector(".box__deco")),t.push(this.contentItem.querySelector(".overlay__content"));var e=!0,i=!1,o=void 0;try{for(var n,a=t[Symbol.iterator]();!(e=(n=a.next()).done);e=!0){var r=n.value;if(null!=r){var l=r.getBoundingClientRect(),s={width:window.innerWidth,height:window.innerHeight};TweenMax.to(r,lineEq(.8,1.2,s.width,0,Math.abs(l.left+l.width-s.width)),{ease:"Expo.easeOut",delay:.2,startAt:{x:""+lineEq(0,800,s.width,0,Math.abs(l.left+l.width-s.width)),y:""+lineEq(-100,100,s.height,0,Math.abs(l.top+l.height-s.height)),rotationZ:""+lineEq(5,30,0,s.width,Math.abs(l.left+l.width-s.width))},x:0,y:0,rotationZ:0})}}}catch(t){i=!0,o=t}finally{try{!e&&a.return&&a.return()}finally{if(i)throw o}}}},{key:"hide",value:function(){var t=this;this.DOM.el.classList.remove("overlay--open"),TweenMax.to(this.DOM.reveal,.5,{ease:"Power3.easeOut",x:"0%",onComplete:function(){t.DOM.close.style.opacity=0,document.body.classList.remove("preview-open"),t.contentItem.style.opacity=0,TweenMax.to(t.DOM.reveal,.5,{delay:0,ease:"Power3.easeOut",x:"100%"})}})}}]),t}(),Grid=function(){function t(e){var i=this;_classCallCheck(this,t),this.DOM={el:e},this.items=[],Array.from(this.DOM.el.querySelectorAll("a.grid__item")).forEach(function(t){var e=new Item(t);i.items.push(e),t.classList.contains("grid__item--noclick")||e.DOM.el.addEventListener("click",function(e){e.preventDefault(),i.openItem(document.querySelector(t.getAttribute("href")))})}),this.overlay=new Overlay,this.overlay.DOM.close.addEventListener("click",function(){return i.closeItem()})}return _createClass(t,[{key:"openItem",value:function(t){if(!this.isPreviewOpen){this.isPreviewOpen=!0,allowTilt=!1,this.overlay.show(t);var e=!0,i=!1,o=void 0;try{for(var n,a=this.items[Symbol.iterator]();!(e=(n=a.next()).done);e=!0){var r=n.value;for(var l in r.DOM.animatable){var s=r.DOM.animatable[l];if(s){var h=s.getBoundingClientRect(),c=void 0,u=void 0,d={width:window.innerWidth,height:window.innerHeight};h.top+h.height/2<d.height/2-.1*d.height?(c=-1*lineEq(20,600,0,d.width,Math.abs(h.left+h.width-d.width)),u=-1*lineEq(20,600,0,d.width,Math.abs(h.left+h.width-d.width))):h.top+h.height/2>d.height/2+.1*d.height?(c=-1*lineEq(20,600,0,d.width,Math.abs(h.left+h.width-d.width)),u=lineEq(20,600,0,d.width,Math.abs(h.left+h.width-d.width))):(c=-1*lineEq(10,700,0,d.width,Math.abs(h.left+h.width-d.width)),u=getRandomInt(-25,25)),TweenMax.to(s,.4,{ease:"Power3.easeOut",delay:lineEq(0,.3,0,d.width,Math.abs(h.left+h.width-d.width)),x:c,y:u,rotationZ:getRandomInt(-10,10),opacity:0})}}}}catch(t){i=!0,o=t}finally{try{!e&&a.return&&a.return()}finally{if(i)throw o}}}}},{key:"closeItem",value:function(){if(this.isPreviewOpen){this.isPreviewOpen=!1,this.overlay.hide();var t=!0,e=!1,i=void 0;try{for(var o,n=this.items[Symbol.iterator]();!(t=(o=n.next()).done);t=!0){var a=o.value;for(var r in a.DOM.animatable){var l=a.DOM.animatable[r];if(l){var s=l.getBoundingClientRect(),h={width:window.innerWidth};TweenMax.to(l,.6,{ease:"Expo.easeOut",delay:.55+lineEq(0,.2,0,h.width,Math.abs(s.left+s.width-h.width)),x:0,y:0,rotationZ:0,opacity:1})}}}}catch(t){e=!0,i=t}finally{try{!t&&n.return&&n.return()}finally{if(e)throw i}}allowTilt=!0}}}]),t}(),allowTilt=!0;new Grid(document.querySelector(".grid")),imagesLoaded(document.querySelectorAll(".box__img"),function(){return document.body.classList.remove("loading")});